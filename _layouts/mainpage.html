<!DOCTYPE html>
<html lang="de">
  {% include html-head.html %}

  <body class="mainpage">
    <div class="page-wrapper">
      <header class="top">
        <a href="{{ '/' | absolute_url }}">
          <img src="{{ '/assets/img/Logo_BI_00.gif' }}" />
        </a>

        <div class="header-content">
          <!-- Slideshow Container -->
          <div class="slideshow-container" style="display: flex; gap: 10px; height: 300px; overflow: hidden;"></div>
          
          <!-- Static Banner -->
          <img src="/assets/img/TextLogo.gif" class="subtitle" alt="Schriftzug der BÃ¼rgerinitiative" />
        </div>
      </header>

      <div id="header-2">
        <nav>
          {% include menu.html %}
        </nav>

        <div class="socialmedia">
          {% include socialmedia.html %}
        </div>
      </div>

      <section id="main-content">
        {{ content }}
      </section>

      {% include footer.html %}
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", async function() {
        const container = document.querySelector(".slideshow-container");
        try {
          const response = await fetch('/assets/img/slideshow');
          if (!response.ok) throw new Error('Network response was not ok');
          const text = await response.text();
          const parser = new DOMParser();
          const htmlDocument = parser.parseFromString(text, "text/html");
          const links = Array.from(htmlDocument.querySelectorAll("a"));
          const imageFiles = links
            .map(link => link.getAttribute("href"))
            .filter(href => href && (href.endsWith(".jpg") || href.endsWith(".jpeg") || href.endsWith(".png") || href.endsWith(".gif")));

          imageFiles.forEach(file => {
            const img = document.createElement("img");
            img.src = `/assets/img/slideshow/${file}`;
            img.alt = "Slideshow Image";
            img.className = "slideshow-image";
            img.style = "flex: 1; object-fit: contain; width: 100%; height: 100%;";
            container.appendChild(img);
          });

          const images = container.querySelectorAll(".slideshow-image");
          const totalImages = images.length;

          if (totalImages > 1) {
            let currentIndex = 0;

            function showNextImage() {
              images.forEach(img => img.style.display = "none");
              const nextIndex1 = currentIndex % totalImages;
              const nextIndex2 = (currentIndex + 1) % totalImages;
              images[nextIndex1].style.display = "block";
              images[nextIndex2].style.display = "block";
              currentIndex = (currentIndex + 2) % totalImages;
            }

            // Initially display two images
            showNextImage();
            setInterval(showNextImage, 3000);
          }
        } catch (error) {
          console.error('There was a problem with the fetch operation:', error);
        }
      });
    </script>
  </body>
</html>
